# Mini‑BNB

> **Mini‑BNB** — минималистичный язык, сочетающий синтаксис `C`/`Python` с выводом готового `.asm`, совместимого с [Irvine32](https://www.kipirvine.com/asm/Irvine/).

---

## Содержание

1. [Быстрый старт](#Быстрый-старт)
2. [Установка окружения](#Установка-окружения)
3. [Синтаксис языка](#Синтаксис-языка)
4. [Примеры](#Примеры)
5. [Архитектура компилятора](#Архитектура-компилятора-(Коротко))


---

## Быстрый старт

```bash
python main.py # запустите компилятор
Введите путь к исходному .txt файлу: demo.txt
# появится demo.txt рядом с исходником
make demo
```

---

## Установка окружения

| Шаг | Что нужно                      | Зачем                                                                     |
| --- | ------------------------------ | ------------------------------------------------------------------------- |
| 1   | Python ≥ 3.8                   | Запуск мини‑компилятора.                                                  |
| 2   | MASM     | Сборка сгенерированного `.asm`.                                           |
| 3   | `irvine32.inc`, `irvine32.lib` | Библиотека для ввода‑вывода.  |

> **Windows‑only.**

---

## Синтаксис языка

### Общие правила

* **Блоки** ограничиваются `{ ... }` или одиночной инструкцией после `if`/`while`.
* **Переменные** объявляются при первом присваивании или вводе: `x = 5` → `x dd ?` в `.data`.
* **Тип данных** — только 32‑бит `int` или **строковый буфер** (`input name, 32`).

### Операторы

| Категория     | Синтаксис                           | Примечание                                    |
| ------------- | ----------------------------------- | --------------------------------------------- |
| Ввод числа    | `input n;`                          | Читает int (`ReadInt`).                       |
| Ввод строки   | `input txt, 64;`                    | Буфер `BYTE 64 DUP(0)` + `ReadString`.        |
| Вывод числа   | `print nums;`                       | `WriteInt`.                                   |
| Вывод строки  | `print "строка\n";`<br>`print txt;` | Поддержка `\n`, двойных кавычек `""`.         |
| Присваивание  | `aa = expr;`                         | Выражения с `+ - * / %` и сравнениями.        |
| `if` / `else` | `if cond: { ... } else: { ... }`    | `cond` — любое логическое сравнение.          |
| `while`       | `while cond: { ... }`               | Условие проверяется в начале каждой итерации. |

### Поддерживаемые операторы

* Арифметика: `+  -  *  /  %`
* Логические: `&&  ||  !` *(унарное `!` пока не реализовано)*
* Сравнения: `==  !=  <  <=  >  >=`
* Приоритет близок к `C`.

---

## Примеры

### 1. Сумма двух чисел

```python
input aa;
input ba;
ca = aa + ba;
print ca;
```

### 2. Обратный отсчёт

```python
i = 10;
while i > 0:
{
    print i;
    print "\n";
    i = i - 1;
}
print "End!\n";
```

### 3. Проверка произведения

```python
input aa;
input ba;
if aa * ba > 50:
{
    print "Product is large!\n";
}else :
{
    print "Product is not large!\n";
}
print "Done\n";
```


### 4. Вывод имени

```python
print "Enter your name:\n";
input name1, 32;
print "Hello, ";
print name1;
print "\nGoodbye!\n";
```

---

## Архитектура компилятора (Коротко)

* **Лексер** — грубый: делит по `;` и `{`, далее по пробелам.
* **infix → RPN** — алгоритм Шунта.
* **RPN → MASM** — стек‑эмуляция (`push`, `pop`, ALU‑инстр.).
* **Условия/циклы** — генерируются через `cmp` + `jcc`, метки создаются `new_label()`.
